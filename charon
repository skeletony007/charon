#!/bin/bash

get_url_body() {
    local URL="$1"
    curl --proto '=https' -sSf "$URL"
}

eval_url_body() {
    local URL="$1"
    eval "$(get_url_body "$URL")"
}

ROOT_URL="https://raw.githubusercontent.com/skeletony007/charon/main"
BASH_UTILS_URL="https://raw.githubusercontent.com/skeletony007/bash-utils/main"

eval_url_body "$BASH_UTILS_DIR/object/object"

action=$1

case $action in
    install|uninstall)
        shift
        programs="$@"
        for program in "$programs"; do
            ferry="$(curl "$ROOT_URL/ferries/$program")"
            create_object $program "$ferry"
            ${$program}_${action}
        done
    ;;
    --help|-h)
        get_url_body "$ROOT_URL/usage"
    ;;
    *)
        echo "Invalid command or missing arguments. Use 'charon --help' for usage instructions."
    ;;
esac

