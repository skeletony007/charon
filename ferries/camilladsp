#!/bin/bash

${obj}_init() {
    create_object ${obj} "$gh_wrapper_data" "HEnquist" "camilladsp"
    create_object ${obj} "$cli_program_data" camilladsp

    ${obj}_BIN_DIR="$HOME/.camilladsp/bin"
}


${obj}_install() {
    local BIN_DIR="${${obj}_BIN_DIR}"

    mkdir -p "$BIN_DIR"
    local PATH="$BIN_DIR:$PATH"

    [ ${obj}_is_latest ] && msg -i "Already up to date."; return
    
    msg -i "Installing CamillaDSP..."
    
    case "$(uname -s)" in
        "Darwin")
            local release="camilladsp-macos-aarch64.tar.gz"
            ;;
        *)
            echo "Unsupported operating system."
            ;;
    esac
    
    ${obj}_download_asset "$release" - | tar -zxvf - -C "$BIN_DIR"
    [ $? -eq 0 ] && msg -i "Installation complete." \
                 || msg -e "Installation failed."; return 1

    add_to_path "$BIN_DIR"
}

